SELECT     c.id AS "Id do curso",     c.fullname AS "Nome do curso",     COUNT(CASE WHEN ue.status = 0 AND cc.timecompleted IS NULL THEN u.id END) AS "Em andamento",     COUNT(CASE WHEN ue.status = 0 AND cc.timecompleted IS NOT NULL THEN u.id END) AS "Conclu√≠dos" FROM     mdl_course c LEFT JOIN     mdl_enrol e ON e.courseid = c.id LEFT JOIN     mdl_user_enrolments ue ON ue.enrolid = e.id LEFT JOIN     mdl_user u ON u.id = ue.userid LEFT JOIN     mdl_course_completions cc ON cc.course = c.id AND cc.userid = u.id WHERE     c.visible = 0     AND u.deleted = 0 GROUP BY     c.id, c.fullname ORDER BY     c.fullname;
