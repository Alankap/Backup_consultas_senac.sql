SELECT      t.id AS "Id Departamento",      t.name AS "Departamento",      c.id AS "Id do Curso",      c.fullname AS "Nome do Curso",      u.id AS "Id do Usu치rio",      u.firstname AS "Nome do Usu치rio",      u.lastname AS "Sobrenome do Usu치rio",      COALESCE(cfd.value, '0') AS "Carga Hor치ria"  FROM      mdl_tool_tenant AS t  JOIN      mdl_tool_tenant_user AS tu ON t.id = tu.tenantid  JOIN      mdl_user AS u ON u.id = tu.userid  JOIN      mdl_user_enrolments AS ue ON ue.userid = u.id  JOIN      mdl_enrol AS e ON e.id = ue.enrolid  JOIN      mdl_course AS c ON c.id = e.courseid  JOIN      mdl_course_completions AS cc ON cc.userid = u.id AND cc.course = c.id  LEFT JOIN      mdl_customfield_data AS cfd ON cfd.instanceid = c.id  LEFT JOIN      mdl_customfield_field AS cff ON cff.id = cfd.fieldid      AND cff.shortname = 'carga_horaria'  WHERE      cc.timecompleted IS NOT NULL      AND (cfd.value LIKE '%hora%' OR cfd.value LIKE '%horas%') ORDER BY      t.name, c.fullname, u.firstname, u.lastname;
