SELECT     COALESCE(ui_data.data, 'Não Informado') AS "Empresa",     g.name AS "Grupo (Empresa)",          u.id AS "ID do Usuário",     CONCAT(u.firstname, ' ', u.lastname) AS "Nome do Usuário",     u.email AS "Email",          c.id AS "ID do Curso",     c.fullname AS "Nome do Curso",     c.shortname AS "Código do Curso",     cat.name AS "Categoria",          FROM_UNIXTIME(ue.timecreated) AS "Data de Inscrição",          CASE         WHEN cc.timecompleted IS NOT NULL THEN 'Concluído'         ELSE 'Incompleto'     END AS "Status de Conclusão",      CASE         WHEN cc.timecompleted IS NOT NULL THEN 100         ELSE 0     END AS "Progresso (%)"  FROM mdl_course c JOIN mdl_course_categories cat ON cat.id = c.category JOIN mdl_enrol e ON e.courseid = c.id JOIN mdl_user_enrolments ue ON ue.enrolid = e.id JOIN mdl_user u ON u.id = ue.userid  LEFT JOIN mdl_course_completions cc ON cc.userid = u.id AND cc.course = c.id  LEFT JOIN mdl_groups_members gm ON gm.userid = u.id LEFT JOIN mdl_groups g ON g.id = gm.groupid AND g.courseid = c.id  LEFT JOIN mdl_user_info_field ui_field ON ui_field.shortname = 'Empresa' LEFT JOIN mdl_user_info_data ui_data ON ui_data.userid = u.id AND ui_data.fieldid = ui_field.id  WHERE     u.deleted = 0     AND cat.name = 'conteúdos exclusivos'  ORDER BY     "Empresa", "Nome do Curso", "Nome do Usuário";
