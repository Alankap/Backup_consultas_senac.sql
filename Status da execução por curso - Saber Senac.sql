SELECT       c.id AS "Id do curso",       c.fullname AS "Nome do curso",       COUNT(ue.id) AS "Inscritos",       COUNT(         CASE               WHEN ue.status = 0 AND cc.timecompleted IS NULL               THEN u.id           END     ) AS "Em andamento",       COUNT(         CASE               WHEN ue.status = 0 AND cc.timecompleted IS NOT NULL               THEN u.id           END     ) AS "Concluídos",       ROUND(         (COUNT(             CASE                   WHEN ue.status = 0 AND cc.timecompleted IS NOT NULL                   THEN u.id               END         ) * 100.0) / NULLIF(COUNT(ue.id), 0), 2     ) AS "Índice de conclusão (%)"   FROM       mdl_course c   LEFT JOIN       mdl_enrol e ON e.courseid = c.id   LEFT JOIN       mdl_user_enrolments ue ON ue.enrolid = e.id   LEFT JOIN       mdl_user u ON u.id = ue.userid   LEFT JOIN       mdl_course_completions cc ON cc.course = c.id       AND cc.userid = u.id   WHERE       c.visible = 1   GROUP BY       c.id, c.fullname   ORDER BY       c.fullname;
