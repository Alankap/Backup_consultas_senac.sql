SELECT      tenant.name AS "Departamento",     course.fullname AS "Curso",      COUNT(DISTINCT CASE          WHEN cc.timecompleted IS NOT NULL               AND user.suspended = 0 THEN user.id      END) AS "Concluídos Ativos",      COUNT(DISTINCT CASE          WHEN cc.timecompleted IS NOT NULL               AND user.suspended = 1 THEN user.id      END) AS "Concluídos Inativos"  FROM mdl_course AS course JOIN mdl_course_completions AS cc ON cc.course = course.id JOIN mdl_user AS user ON user.id = cc.userid AND user.deleted = 0 JOIN mdl_tool_tenant_user AS tenant_user ON tenant_user.userid = user.id JOIN mdl_tool_tenant AS tenant ON tenant.id = tenant_user.tenantid  GROUP BY tenant.name, course.fullname ORDER BY tenant.name, course.fullname;
