SELECT   u.id AS "ID do Aluno",   CONCAT(u.firstname, ' ', u.lastname) AS "Nome do Aluno",   c.id AS "ID do Curso",   c.fullname AS "Nome do Curso",   fb.name AS "Atividade de Feedback",   CASE     WHEN fb.completionsubmit = 1 AND fc.id IS NOT NULL       THEN DATE_FORMAT(FROM_UNIXTIME(fc.timemodified), '%d/%m/%Y %H:%i:%s')     ELSE NULL   END AS "Data da Tentativa",   CASE     WHEN fb.completionsubmit = 1 AND fc.id IS NOT NULL THEN 'Concluído'     ELSE 'Não iniciado'   END AS "Status da Avaliação",   MAX(fv.value) AS "Nota Final" FROM   mdl_user u   JOIN mdl_user_enrolments ue ON ue.userid = u.id   JOIN mdl_enrol e ON e.id = ue.enrolid   JOIN mdl_course c ON c.id = e.courseid   JOIN mdl_feedback fb ON fb.course = c.id   JOIN mdl_feedback_item fi ON fi.feedback = fb.id     AND LOWER(fi.name) LIKE '%o quanto você recomendaria este curso para um amigo?%'   LEFT JOIN mdl_feedback_completed fc ON fc.feedback = fb.id AND fc.userid = u.id   LEFT JOIN mdl_feedback_value fv ON fv.completed = fc.id AND fv.item = fi.id WHERE   c.visible = 1 GROUP BY   u.id,   c.id,   fb.id,   fc.id,   fc.timemodified ORDER BY   c.fullname,   u.firstname,   u.lastname,   fb.name;
