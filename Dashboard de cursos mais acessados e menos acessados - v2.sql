SELECT     c.id AS "ID do curso",     c.fullname AS "Curso",     COUNT(l.id) AS "Total de acessos",     CASE         WHEN u.department IS NOT NULL AND u.department != '' THEN 'Saber Senac'         ELSE 'Demais Perfis'     END AS "Perfil do aluno" FROM     mdl_logstore_standard_log l JOIN     mdl_course c ON l.courseid = c.id JOIN     mdl_user u ON l.userid = u.id WHERE     l.action = 'viewed'     AND c.visible = 1 GROUP BY     c.id,      "Perfil do aluno" ORDER BY     "Total de acessos" DESC;
