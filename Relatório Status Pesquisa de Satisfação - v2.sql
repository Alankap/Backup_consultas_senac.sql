SELECT      c.id AS "Id do Curso",     c.fullname AS "Nome do Curso",     CONCAT(u.firstname, ' ', u.lastname) AS "Nome do Aluno",     fb.name AS "Nome da Pesquisa",     CASE         WHEN fc.id IS NULL THEN 'Não iniciado'         WHEN fc.timemodified IS NOT NULL AND fc.timemodified < NOW() THEN 'Concluído'         ELSE 'Em andamento'     END AS "Status da Pesquisa",     q.name AS "Pergunta",     a.value AS "Resposta",     COUNT(a.value) AS "Total de Respostas",     ROUND(         (COUNT(a.value) * 100) / (             SELECT COUNT(*)             FROM mdl_feedback_completed fc_sub             WHERE fc_sub.feedback = fb.id         ),         2     ) AS percentual_resposta FROM      mdl_feedback fb JOIN      mdl_course c ON c.id = fb.course JOIN      mdl_feedback_item q ON q.feedback = fb.id LEFT JOIN      mdl_feedback_completed fc ON fc.feedback = fb.id LEFT JOIN      mdl_feedback_value a ON a.completed = fc.id AND a.item = q.id LEFT JOIN      mdl_user u ON u.id = fc.userid WHERE      fb.course IS NOT NULL GROUP BY      c.id, fb.id, q.id, a.value, u.id ORDER BY      c.fullname, fb.name, "Pergunta", "Resposta";
